(function(g){var h=window.AmazonUIPageJS||window.P,u=h._namespace||h.attributeErrors,d=u?u("DigitalVideoWebPlayerIntegration",""):h;d.guardFatal?d.guardFatal(g)(d,window):d.execute(function(){g(d,window)})})(function(g,h,u){g.when("logging","dv-web-player-cfg","dv-ajax-util").register("dv-player-load-src",function(d,f,b){var a=f.get("source"),e=d.create("dv-player-src",g),k=f.get("retryTimeout")||100,x=f.get("retryAttempts")||6,t=0,p=function(c,a){var b=document.createElement("script");b.type="text/javascript";
b.crossOrigin="anonymous";b.readyState?b.onreadystatechange=function(){if("loaded"===b.readyState||"complete"===b.readyState)b.onreadystatechange=null,a()}:b.onload=function(){a()};b.src=c;b.onerror=l("Loader");b.async=!0;e.debug("loading web player source",c,b);document.getElementsByTagName("head")[0].appendChild(b)},q=function(c){h.ue&&"function"===typeof h.ue.count&&h.ue.count("DVWebPlayer:"+c+":load:failure",1);h.navigator&&h.navigator.onLine&&e.fatal("Failed to load DVWebPlayer "+c+" script after "+
t+" retries. SRC: "+a);b({url:"/gp/video/ajax/log-device-info.html/ref\x3datv_log_device_info",data:{description:"DVWebPlayer"+c+"LoadFailed"}})},l=function(a){return function(){++t<=x?h.setTimeout(c,k+k*Math.pow(t,2)):q(a)}},r=function(){h.WebPlayer&&"function"===typeof h.WebPlayer?(e.debug("WebPlayer Loaded successfully",h.WebPlayer),g.register("dv-player-ready",function(){return new h.WebPlayer})):l("Player")()},c=function(){a?p(a,r):q("SourceMissing")};c();return{ready:function(c){g.when("dv-player-ready").execute(c)}}});
"use strict";g.when("promise-polyfill","dv-player-load-src","dv-web-player-cfg","dv-player-default-view","dv-registry","dv-web-player-capabilities","logging").register("dv-player-integration",function(d,f,b,a,e,k,h){function g(){var c=b.get("playerConfig"),a={customerId:c.customerId,domElement:document.getElementById(c.domElementId),marketplaceId:c.marketplaceId,sessionId:c.sessionId,locale:c.locale};c.useBetaPlayer&&(a.playerBeta=c.useBetaPlayer);c.clientId&&(a.clientId=c.clientId);return a}function p(){return["initialized",
"closed","playing","pinRequired"]}function q(c){f.ready(function(a){a.on(c,function(){l(c)})})}function l(c,a){n.debug("action called",c,a);for(var b=v.query(c),m=[],e=function(){f.ready(function(c){"function"===typeof a&&a(c)})},k=function(){n.debug("Promise failed",c,a)},g=0;g<b.length;g++){var h=b[g](w.getLastTitle());h&&"object"===typeof h&&"function"===typeof h.then&&m.push(h)}n.debug("callbacks registered for",c,m);m.length?1===m.length?d.resolve(m[0]).then(e,k):d.all(m).then(e,k):e()}function r(a){var b=
a&&a.ref,m=function(m){m.play(g(),c(a),{clickstreamRefMarker:b})};n.debug("play called",a);f.ready(function(){l("play",m)})}function c(c){c=c||{};var a={trailer:c.trailer||!1,useFullView:c.useFullView||!1,position:c.position||0,videoType:c.videoType};c.lcid?(a.asin=c.lcid,a.live=!0):c.asin&&(a.asin=c.asin);return a}function m(a){a=c(a);a.startEpoch=parseInt((new Date).getTime()/1E3,10);return a}var n=h.create("dv-player-integration"),v=e(),w=function(){var c=[];return{addTitle:function(a){c.push(a)},
getLastTitle:function(){return c.slice(-1)[0]}}}();f.ready(function(c){c.initialize(g());n.debug("Initialized with",g());for(var e=0,f=p().length;e<f;e++)q(p()[e]);c.on("asinChanged",function(c){l("asinChanged",function(){w.addTitle(m(c))})});b.get("useDefaultView")?v.add("play",a.open).add("closed",a.close):n.debug("Custom view requested - defaults not registered")});return{on:v.add,runBeforePlay:function(c){v.add("beforePlay",c)},onCapabilities:k,prepare:function(a){var b=function(b){b.prepare(g(),
c(a))};n.debug("prepare called",a);f.ready(function(){l("prepare",b)})},play:function(c){c&&w.addTitle(m(c));l("beforePlay",function(){r(c)})},stop:function(){n.debug("stop called");l("stop",function(c){c.initialize(g());l("closed")})}}});"use strict";g.register("dv-player-default-view",function(){return{open:function(){document.getElementById("dv-web-player").className="dv-player-fullscreen";document.getElementsByTagName("body")[0].style.overflow="hidden"},close:function(){document.getElementById("dv-web-player").className=
"";document.getElementsByTagName("body")[0].style.overflow="visible"}}});"use strict";g.when("dv-player-load-src","dv-player-integration","logging").register("dv-web-player-csm",function(d,f,b){var a,e=b.create("dv-player-src");return function(b){d.ready(function(){e.info("CSM! whenInitialized",b);"function"===typeof h.uex&&h.uex("ld","web-player-src",{wb:1});"function"===typeof h.uet&&h.uet("cf",b,{wb:1})});f.on("pinRequired",function(){e.info("CSM! pinRequired",b);a=!0});f.on("playing",function(){a||
(a=!0,e.info("CSM! first-frame",b),"function"===typeof h.uex&&h.uex("ld",b,{wb:1}))})}});"use strict";g.when("dv-web-player-cfg","dv-player-integration","dv-player-default-view").execute(function(d,f){!d.get("autoplay")&&d.get("videoConfig")&&f.prepare(d.get("videoConfig"))});"use strict";g.when("logging").register("dv-registry",function(d){var f=d.create("dv-registry");return function(){var b={};return{add:function(a,e){if(a&&"function"===typeof e)return f.debug("Updated registry",a,e,b),b[a]=b[a]||
[],b[a].push(e),this;f.error("Unable to register fn",a,e)},query:function(a){return b[a]||[]}}}});"use strict";g.register("promise-polyfill",function(){function d(){}function f(c,a){return function(){c.apply(a,arguments)}}function b(c){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof c)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=u;this._deferreds=[];p(c,this)}function a(c,a){for(;3===c._state;)c=c._value;
0===c._state?c._deferreds.push(a):(c._handled=!0,l(function(){var b=1===c._state?a.onFulfilled:a.onRejected;if(null===b)(1===c._state?e:k)(a.promise,c._value);else{var f;try{f=b(c._value)}catch(d){k(a.promise,d);return}e(a.promise,f)}}))}function e(c,a){try{if(a===c)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"===typeof a||"function"===typeof a)){var e=a.then;if(a instanceof b){c._state=3;c._value=a;g(c);return}if("function"===typeof e){p(f(e,a),c);return}}c._state=
1;c._value=a;g(c)}catch(d){k(c,d)}}function k(c,a){c._state=2;c._value=a;g(c)}function g(c){2===c._state&&0===c._deferreds.length&&l(function(){c._handled||r(c._value)});for(var b=0,e=c._deferreds.length;b<e;b++)a(c,c._deferreds[b]);c._deferreds=null}function t(c,a,b){this.onFulfilled="function"===typeof c?c:null;this.onRejected="function"===typeof a?a:null;this.promise=b}function p(c,a){var b=!1;try{c(function(c){b||(b=!0,e(a,c))},function(c){b||(b=!0,k(a,c))})}catch(f){b||(b=!0,k(a,f))}}if("function"===
typeof h.Promise)return h.Promise;var q=setTimeout,l="function"===typeof setImmediate&&setImmediate||function(c){q(c,0)},r=function(c){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",c)};b.prototype["catch"]=function(c){return this.then(null,c)};b.prototype.then=function(c,b){var e=new this.constructor(d);a(this,new t(c,b,e));return e};b.all=function(c){var a=Array.prototype.slice.call(c);return new b(function(c,b){function e(d,k){try{if(k&&("object"===
typeof k||"function"===typeof k)){var g=k.then;if("function"===typeof g){g.call(k,function(a){e(d,a)},b);return}}a[d]=k;0===--f&&c(a)}catch(h){b(h)}}if(0===a.length)return c([]);for(var f=a.length,d=0;d<a.length;d++)e(d,a[d])})};b.resolve=function(a){return a&&"object"===typeof a&&a.constructor===b?a:new b(function(b){b(a)})};b.reject=function(a){return new b(function(b,e){e(a)})};b.race=function(a){return new b(function(b,e){for(var d=0,f=a.length;d<f;d++)a[d].then(b,e)})};b._setImmediateFn=function(a){l=
a};b._setUnhandledRejectionFn=function(a){r=a};return b});g.register("dv-serialize",function(){return function(d){var f="",b=0,a;for(a in d)if(d.hasOwnProperty(a))switch(Function.prototype.call(String,null,d[a])){case "[object Array]":for(var e in d[a])d[a].hasOwnProperty(e)&&(f+=(b++?"\x26":"?")+a+"[]\x3d"+encodeURIComponent(d[a][e]));break;case "[object Object]":for(var k in d[a])d[a].hasOwnProperty(k)&&(f+=(b++?"\x26":"?")+a[k]+"\x3d"+encodeURIComponent(d[a][k]));break;default:f+=(b++?"\x26":"?")+
a+"\x3d"+encodeURIComponent(d[a])}return f}});g.when("dv-serialize").register("dv-ajax-util",function(d){return function(f){f=f||{};var b=function(){},a=new XMLHttpRequest,e={url:f.url||!1,method:0<=["POST","GET"].indexOf(f.method)?f.method:"GET",complete:f.complete||b,success:f.success||b,error:f.error||b,data:f.data||{},cache:f.cache?1:0,params:""};a.onreadystatechange=function(){if(4===a.readyState)if(e.complete(a,a.statusText),200===a.status){var b=a.response||a.responseText,d;a:{try{JSON.parse(b)}catch(f){d=
!1;break a}d=!0}d&&(b=JSON.parse(b)||b);e.success(b,a.statusText,a)}else e.error(a,a.statusText)};e.data&&(e.params=d(e.data),"POST"===e.method?(a.open("POST",e.url,!0),a.setRequestHeader("x-requested-with","XMLHttpRequest"),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(e.params)):(a.open("GET",e.url+e.params,!0),a.setRequestHeader("x-requested-with","XMLHttpRequest"),a.send()))}});"use strict";g.when("dv-player-load-src").register("dv-web-player-capabilities",function(d){function f(a){d.ready(function(b){b.on("playerCapabilities",
a)})}var b;f(function(a){b=a});return function(a){"undefined"!==typeof b?a(b):f(a)}});g.when("dv-player-integration","dv-ajax-util").execute(function(d,f){function b(a){d.on(a,function(b){if(b){var d={trailer:b.trailer,action:a};"play"!==a&&(d.secondsPlayed=b&&parseInt((new Date).getTime()/1E3)-b.startEpoch);b.asin&&(d.titleId=b.asin);b.lcid&&(d.lcid=b.lcid);f({url:"/gp/video/widgets/main-section/ajax/analytics.html/ref\x3ddv_play_action",data:d})}})}b("play");b("asinChanged");b("closed")});"use strict";
g.when("dv-player-integration","promise-polyfill").register("dv-live-incompatable",function(d,f){return function(b){function a(a){return function(b,f){if("Live"===a.videoType||a.lcid||a.live)d.onCapabilities(e(b,f));else b()}}function e(a,d){return function(e){!1===e.capabilities.supportsLive?(b(),d()):a()}}d.runBeforePlay(function(b){return new f(a(b))})}})});